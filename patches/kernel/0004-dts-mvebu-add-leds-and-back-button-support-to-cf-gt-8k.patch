From 1b8af5085e085a88594343995f2caf030ecd4ce0 Mon Sep 17 00:00:00 2001
From: Rabeeh Khoury <rabeeh@solid-run.com>
Date: Tue, 6 Mar 2018 20:56:31 +0200
Subject: [PATCH] dts: mevbu: add leds and back button support for cf-gt-8k

Signed-off-by: Rabeeh Khoury <rabeeh@solid-run.com>
---
 .../dts/marvell/armada-8040-clearfog-gt-8k.dts     |   34 +++++++++++++++++---
 1 file changed, 30 insertions(+), 4 deletions(-)

diff --git a/arch/arm64/boot/dts/marvell/armada-8040-clearfog-gt-8k.dts b/arch/arm64/boot/dts/marvell/armada-8040-clearfog-gt-8k.dts
index 9285065..457827d 100644
--- a/arch/arm64/boot/dts/marvell/armada-8040-clearfog-gt-8k.dts
+++ b/arch/arm64/boot/dts/marvell/armada-8040-clearfog-gt-8k.dts
@@ -45,6 +45,8 @@
  * Device Tree file for SolidRun's ClearFog GT 8K
  */
 
+#include <dt-bindings/input/input.h>
+#include <dt-bindings/gpio/gpio.h>
 #include "armada-8040.dtsi"
 
 / {
@@ -118,10 +120,6 @@
 					marvell,pins = "mpp39";
 					marvell,function = "gpio";
 				};
-				gpio_reset_pins: gpio-reset-pins {
-					marvell,pins = "mpp39";
-					marvell,function = "gpio";
-				};
 				led0_pins: led0-pins {
 					marvell,pins = "mpp40";
 					marvell,function = "gpio";
@@ -339,6 +337,34 @@
 		};
 	};
 
+	leds {
+		compatible = "gpio-leds";
+		pinctrl-0 = <&led0_pins
+			     &led1_pins>;
+		pinctrl-names = "default";
+		led0 {
+			label = "led0";
+			gpios = <&cpm_gpio1 8 GPIO_ACTIVE_LOW>;
+			default-state = "on";
+		};
+		led1 {
+			label = "led1";
+			gpios = <&cpm_gpio1 9 GPIO_ACTIVE_LOW>;
+			default-state = "on";
+		};
+	};
 
+	keys {
+		compatible = "gpio-keys";
+		pinctrl-0 = <&gpio_reset_pins>;
+		pinctrl-names = "default";
+		button_0 {
+			/* The rear button button */
+			label = "Rear Button";
+			gpios = <&cpm_gpio1 7 GPIO_ACTIVE_LOW>;
+			linux,can-disable;
+			linux,code = <BTN_0>;
+		};
+	};
 };
 
-- 
1.7.9.5

